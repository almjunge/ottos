/* parser.c
 *
 * Copyright (c) 2011 The ottos project.
 *
 * This work is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Lesser General Public License as published by the Free
 * Software Foundation; either version 2.1 of the License, or (at your option)
 * any later version.
 *
 * This work is distributed in the hope that it will be useful, but without
 * any warranty; without even the implied warranty of merchantability or
 * fitness for a particular purpose. See the GNU Lesser General Public License
 * for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; if not, write to the Free Software Foundation,
 * Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 *
 *
 *  Created on: 21.10.2011
 *      Author: Thomas Bargetz <thomas.bargetz@gmail.com>
 */

#include <stdlib.h>
#include <ottos/io.h>
#include <ottos/kernel.h>

#include "parser.h"

// record types defines
#define PARSER_RECTYPE_DATA 						0x0
#define PARSER_RECTYPE_EOF 							0x1
#define PARSER_RECTYPE_EXTENDED_SEGMENT_ADDRESS 	0x2
#define PARSER_RECTYPE_START_SEGMENT_ADDRESS		0x3
#define PARSER_RECTYPE_EXTENDED_LINEAR_ADDRESS 		0x4
#define PARSER_RECTYPE_START_LINEAR_ADDRESS 		0x5

int parser_hex_to_int(char hex) {
	if (hex == '0') {
		return 0;
	} else if (hex == '1') {
		return 1;
	} else if (hex == '2') {
		return 2;
	} else if (hex == '3') {
		return 3;
	} else if (hex == '4') {
		return 4;
	} else if (hex == '5') {
		return 5;
	} else if (hex == '6') {
		return 6;
	} else if (hex == '7') {
		return 7;
	} else if (hex == '8') {
		return 8;
	} else if (hex == '9') {
		return 9;
	} else if (hex == 'A') {
		return 10;
	} else if (hex == 'B') {
		return 11;
	} else if (hex == 'C') {
		return 12;
	} else if (hex == 'D') {
		return 13;
	} else if (hex == 'E') {
		return 14;
	} else if (hex == 'F') {
		return 15;
	}
	return 0;
}

code_t* parser_parse(code_bytes_t* code_bytes) {

	// example for an intel32 hex file:
	//:020000021000EC
	//:10010000214601360121470136007EFE09D2190140
	//:100110002146017EB7C20001FF5F16002148011988
	//:10012000194E79234623965778239EDA3F01B2CAA7
	//:100130003F0156702B5E712B722B732146013421C7
	//:00000001FF

	// :020000021000EC
	// ':' = Startcode
	// the following 2 hex numbers = Byte count (02)
	// the following 4 hex numbers = Address (0000)
	// the following 2 hex numbers = Record type (02)
	// the following 'Byte count' hex numbers = Data (1000) (02 = 2 Bytes = 4 hex numbers for this example)
	// the last 2 hex numbers = Checksum (EC)

	BOOLEAN ignore_current_code = FALSE;
	int i = 0;
	int address_offset = 0;
	code_t* code_begin = malloc(sizeof(code_t));

	code_t* code = code_begin;
	code->next = NULL;
	code->bytes = NULL;

	while (code_bytes->byte_0[i] != '\0') {
		// IGNORE START CODE
		i++;

		// PARSE BYTE COUNT
		// the current + the next index are the 2 hex numbers defining the byte count
		// the first hex number is multiplied with 16 because we read from the left to the right (A1 = 10 * 16 + 1 = 161)
		code->byte_count = parser_hex_to_int(code_bytes->byte_0[i]) * 16
				+ parser_hex_to_int(code_bytes->byte_0[++i]);
		//code->byte_count *= 4; // 4 files with bytes ..?

		// PARSE ADDRESS
		i++;
		code->address = parser_hex_to_int(code_bytes->byte_0[i]) * (16 * 16 * 16)
				+ parser_hex_to_int(code_bytes->byte_0[++i]) * (16 * 16)
				+ parser_hex_to_int(code_bytes->byte_0[++i]) * (16)
				+ parser_hex_to_int(code_bytes->byte_0[++i])
				+ address_offset;

		// PARSE RECORD TYPE
		i++;
		code->record_type = parser_hex_to_int(code_bytes->byte_0[i]) * 16
				+ parser_hex_to_int(code_bytes->byte_0[++i]);

		// PARSE DATA
		i++;
		if (code->record_type != PARSER_RECTYPE_DATA) {
			ignore_current_code = TRUE;

			if (code->record_type == PARSER_RECTYPE_EOF) {
				// parsing finished
				break;
			} else if (code->record_type == PARSER_RECTYPE_EXTENDED_LINEAR_ADDRESS) {
				int j = 0;

				address_offset = 0;
				for(j = 0; j < code->byte_count; j++) {
					address_offset = parser_hex_to_int(code_bytes->byte_0[i]) * 16
							+ parser_hex_to_int(code_bytes->byte_0[i + 1]);

					i += 2;
				}

				address_offset *= 0x10000;
			} else {
				kernel_print("Cannot parse Intel hex file (The record type is unknown)");
				parser_free_parsed_code(code_begin);
				return NULL;
			}
		} else if (code->record_type == PARSER_RECTYPE_DATA) {
			// parse data
			int j = 0;
			// 4 = number of bytes (byte0, byte1, byte2, byte3)
			code->bytes = malloc(sizeof(byte_t) * code->byte_count * 4);

			// 1 byte = 2 hex numbers therefore i is increased by 2 each step
			// 4 = number of bytes (byte0, byte1, byte2, byte3)
			for (j = 0; j < code->byte_count * 4; j += 4) {
				code->bytes[j] = parser_hex_to_int(code_bytes->byte_0[i]) * 16;
				code->bytes[j] += parser_hex_to_int(code_bytes->byte_0[i + 1]);

				code->bytes[j + 1] = parser_hex_to_int(code_bytes->byte_1[i]) * 16;
				code->bytes[j + 1] += parser_hex_to_int(code_bytes->byte_1[i + 1]);

				code->bytes[j + 2] = parser_hex_to_int(code_bytes->byte_2[i]) * 16;
				code->bytes[j + 2] += parser_hex_to_int(code_bytes->byte_2[i + 1]);

				code->bytes[j + 3] = parser_hex_to_int(code_bytes->byte_3[i]) * 16;
				code->bytes[j + 3] += parser_hex_to_int(code_bytes->byte_3[i + 1]);

				i += 2;
			}
		}

		// link the code in a linked list
		if(ignore_current_code == FALSE) {
			code->next = malloc(sizeof(code_t));
			code = code->next;
		} else {
			free(code->bytes);
		}

		code->next = NULL;
		code->bytes = NULL;
		ignore_current_code = FALSE;

		// PARSE CHECKSUM
		i++;
		i++;
	}

	return code_begin;
}

void parser_free_parsed_code(code_t* code) {
	code_t* next;
	code_t* current;

	current = code;
	while(current != NULL) {
		next = current->next;
		free(current->bytes);
		free(current);
		current = next;
	}
}

#define test_byte_0 ":020000040002F8:20000000000029F09001428C01087C010400500400FBF0110403070403040404FB0403016A:200080000101FB0304020400EA1EFF84801401000000043CFF08000000042C40000005007A:20010000642800071600080C040000000700021F048C01003A0C0800002408100C040000CB:20018000000428180000060068240400014C000C0C04000000070002EC048C0100110C0871:2002000000000C08000F0C080400001401055C03025403FF08040708040103080402F40CA1:200280000011080403ED080404F4080408E500000018E00400000018E5000F0E0804000032:20030000000424B800009C007C20044CA000CC0114044CA01F00001800081C5F002C00001E:200380002404001C0800140C000C107000000000F80400F00800E80C00E0106000D4000059:20040000CC0400C40800BC0C00B4105000A80000A00400980800900C00881040007C000088:200480007404006C0800640C005C103000500000480400400800380C003010200014019B2C:2005000001A901B701C501D301E11100E80800341200D408002E0C00BC081028060407EAA9:200580008EEE01F2000E0C0400000004048C01001E0C040000180110000800041E040000B4:20060000180110000C00041E0800000400181A080C000004001C00060010001817040500C3:200680000400181004040C001020343C949038343C949038343C949038343C949038343C4A:20070000949038343C94903814A80C040000000428AA00000600A424040000DE000C0C0443:200780000000000700027E048C0100A30C08000096080800007B0808000081080800008F39:2008000008400C0400000004247200002200E42004000000040004040400080804000C0C80:2008800004001010040014140400181804001C1C000C0C04000000042842000005002824BD:200900000400BE000C0E0804000C0400E40E000428DF090400DB050800EF01F1F50E080001:20098000000004541700000900805000955B0096285700080C040000000B0002285F00025C:200A00005C048C0100090C0400041E00300400040008B1085C0802453000003004000400A2:200A800008A2085208023630000030040004000893083908022730000034040004000884A5:200B00000839023008173034002040300E0000B80B0808B8F2000402042600000E0014046E:200B80000000000C03000C2B0C00040C3700F50C04000C0C04040C001A101000001000043D:200C00000C08C4000803000808BF0C01000C04040C0814000804000404040C08081E08047B:200C8000000408081E0C0804000800000A0804000408040400010100000C1E0F00000C0889:200D0000000C8400040304080500000C0C000F0F04000000040C2500001E00A008000400F2:200D8000000008630008050008085E0800000C0C00000C00040054000400000F0C040000C6:200E00000004048C0100080C04000004041E001C0C08040008000C441408140C0C530010C8:200E80003B18181022001005100408141800001C000E040004430000640808000000045D0E:200F0000080800000E500F0C08040000000410AC00000B00A80C000400000804000C080099:200F8000000F0C0400000004048C0100A20C04000000041E04000004041E04000008041E71:20100000600800000004B87400000B00F8B4002AA80000AC0000B000080C04000000040433:201080008C01006B0C0C0400004E00120000B004000000B0A8000400B001B0020000B00CAD:201100000C00002100010809001B00FB0000AC0C040000AC000C0000ACA8000400AC01AC55:20118000020000AC040C04000000B0AC00070000AC0C0001010000041E04000000B0AC00EE:20120000070000AC0C0001010000041E70080000000404E8000002007C0000080C040000ED:201280000004048C0100E80C00380400088608A5343400FC08028F38008800180400043938:201300000808000C08040D1A000C0CCD1F000C0CB91A000C0CD215041410000C0CD9140063:20138000109D090D00EB01E401DD01EAFF1800080000000460860000070061006008000C0C:201400005C00080C040000000B00020C6600005D048C01007A0CA00800000004105E00004B:201480000400100C006800080C0400000007000275048C0100590C0800000002013E0000EF:20150000080C0400000002013300000C0E080400043D0E0C04000400BC0C0C040004D40C38:201580000C0400000002011400000C0E0804000408AB0E0C040004B70C0C0400000002014F:20160000FB00000C040000041E04000004041E0C000000040CE600000B049B0000C0003EC9:201680000004000008000C0C0400000006004B048C0100DB0C0E000004C900080004C400AE:2017000004000004C30004000000080C08B5000408008600080174040800080400ED0E0EF9:201780000000016E040008049A000004017C08010804950000040172FF040E080000B500C0:2018000004810000016C00047F000001650000040139000004080C0400008C0C5F0C0F047D:2018800000000C0C04A100080404080000FF000F0400041E0400041E0C0400000004013CC8:20190000000002000419000C0E0400000004022C0000090408EA0000DE0004011B000E0E3F:20198000040000000403150000090408D30000D7000402CC000E080000000410FF00000469:201A0000009400900C00080C0400000007000097048C0100FA0C040028041E04002C041EA9:201A80000400041E5361656320F8200018040004480801140914080C0C1401001401140468:201B000032140CF00800100604290C010017041000F501FF18000800F4000008E800E40023:201B80006AD00100FF080014080400B00C0010100400100C7F00FB0C0887100110080108A0:201C0000041000EE14000014080400300C00101004000F0C5200FB10080C0C6E1001100403:201C80001000EF10140008000000040C4F000006002A009408009E00080C04000000070031:201D0000002B048C0100480C0E0DDA0D5A020DE80E001C21185500948800B898A80800008C:201D800000040C18000004001B00440800080C0400000007000024048C0100130CD00637B0:201E0000080400081E08000000040CF000000A00B00800A8000000EF000400080C04000013:201E80000004048C0100E80C0E0000049208000810040400F00008043C000800F3EBE800E7:201F00000400041E1E08000000040CB000000400B300700800080C04000000070000BC04A7:201F80008C0100AB0C04002000041E080400081E48000E0D050D2E020D110E0800000004A8:202000000C7A000004007D00F40800080C0400000007000086048C0100750C0400A400045A:202080001E080400081E0C00008E000404680C0604010450040CF8017F0004042C0CE804C7:20210000010414040CF8E06800803000B2000C040004080003040099B20100240484EF30BA:20218000010014040E011C2014001E0C001E1ED8D400600D790D30020D88600000F0003873:20220000300105910000F000063404F500F0F48C001EB01E080400000400011200081E0827:202280000400000400011200081E080400000400011200081E080400000400011200000190:20230000081E0C0804000C1E011E01030700010103FB00011EFF01041201080D01100810B7:2023800001010F0F1210FC100802040402B20100011E001E01032B032F1008101018181012:20240000FB1010010C0D0C10030404010608080102080801010402010101B2B20100B2B262:202480000101010101010103F9011302CB040704B423B204F9040102B2B20201010101044E:2025000009040423032302230104F50401010101FB0100141000000004000800000C1000F2:202580000000140000181410000000040008000C10140000001800001C1814101800000423:202600000008000C14100602001C000800000400540254040106005801040401F8081E0419:2026800000000720041E080000E000F20808040000040C081E08000080F208080000BFEC98:202700000808000000E6080804000004FF0000044C04081E080400000420081E08B4000020:20278000B40C000C00B40C000C081E08B40009000C040C08000C040C03B400F2F6081E08A9:202800000400FF000C080CFF081E0014040004080707000C800C000C400C00BCBE00BECA4C:202880000010DB1400080400000408081E040000081008041E040000104010041E0400002B:202900000004041E040000101010041E001C18080400080C0707004D00600C00690018C4DB:20298000000CA600046D1C000800001401040400000001081E080000142004040000000167:202A0000081E08040004000000081E08040000040000081E307400003068000000040005DF:202A8000000308023C01083C0000EE30241C000C0000001EF0DCE850AC08000000EDB708BC:202B000008000001EDB00808000002EDA90808000003EDA200081000003C04040000000465:202B8000000004EC00E8003C00CC0000090C0C0500040405041E040000F2001E8010000C50:202C00000010000A0004050000040003060204000004F000041070001812000000B7F00035:202C80003C070304E000FF0000D803003C00700304F405B406080506040400BF00000100EF:202D0000003C0470700060700000008938003C30040C030007030001000403F8FF03040073:202D800036F0810001310001000404050000008C0000008C00000A0006056D00000C0400A2:202E000003140006066200000C0409065B055900000C000C08060063003C70F0000400012B:202E800003017200560000029A00F0000027B0003C00B407860304003201093E092F7C84CD:202F0000000601040004168C140C0904101A08030100070013010005040400051E1B0835FA:202F800000000807060B075B003C05B63CBA090809010005040401000449003C07F0F00029:20300000010131046802050003010A003D0000C528003C070304182000050016040A000C1B:2030800004070C09080103070C08FA00040200EB010003003C00F0B001070004020A00BB4B:2031000008000C0003090400B2003C07F0109004C4000010032100100104FC10D400CCC881:20318000D0D8FC1E001E00FBFE4C1000003C3C000001043C280000003C18003CE810D4E8D5:02320000E4D810:2033F80000000080001C0058006C000000F800A000F800F80000005800AC00940000003005:203478000084006C0000007000A00000000C00E8000000E400AC000000B800F80000007090:2034F80000F8000000C00000001C00000098000000D000000078000000F000000088000088:023578000064ED:2035800004B4B504B8E504BCD904C00104C4E90C881A03000494000CA800981C04C800048D:20360000CC0004D00104D4B804D8B804DC3404E00004E40004E80004EC0304F00004F4003A:013680000049:02368400440000:00000001FF"
#define test_byte_1 ":020000040002F8:200000000000004000000800000050000000084000FF80001000002000303020FF20003082:200080003020FF2020002000FFFFFF3635C0000010001008FF4000C000000008000000C09A:2001000000000010000080401000C00000001000C0CF00000880400000008035401000C013:2001800000000008000000C00000100020000080401000C00000001000C0CF000008804070:2002000000000180354030201000C0C00000041008041007100008C0001008C0001007C04A:200280000000C0001007C0001007C0001007C000C0100700C000C01007008040201000C0FB:2003000000000007000000C00300C002CD00C2C0C0C0020D00C000C000C0C000C00300C0F0:200380000300C00300C00300C0030000C00300C00200C00200C00200C0020000C00200C0C4:200400000200C00200C00200C0020000C00200C00200C00200C00200C0020000C00200C048:200480000200C00200C00200C0020000C00200C00200C00200C00200C0020000C0C0C0FF0B:20050000C0FFC0FFC0FFC0FFC0FF0000113020FF0000113020FF0000113020FF00C0C0FF81:20058000C0FFC0FF0080401000C00000C0CF00000780D000C0C000CC0000C0D0FFD000C0FC:20060000C000CC0000C0D0FF4000C000C01007804000C0C0C0C00000C000C010070000C0D1:2006800000C010070000804C4C350000000000000000000020202020204040404040606096:2007000060606080808080802A20401000C000000006000000C00000100020FE008040101B:2007800000C000000010FFC0CF00000680400000FF80400000FF80400000FF80400000FFF9:200800008035401000C000000006000000C00200C000C0C0C000C0C0C000C0C0C000C0C04B:20088000C000C0C0C000C0C0C000C0C0C000C0C00080401000C000000006000000C0020000:200900001000FF008040201000000010FF00C00010FF000010FF00C000FFC0FFFF804000AE:20098000C000000006000000C001000010FFC01000FF0080401000C00000C01000FF001083:200A0000FFC0CF00000680D000D0FF40D01000200010FF00FF0010FFD08040D01000200036:200A800010FF00FF0010FFD08040D01000200010FF00FF0010FFD08040D01000200010FFED:200B000000FF100000FF00D080353535400000100000100005000000000100008040D010D2:200B800000C0C0C000001000000010200000FFC0C0000000C0C010000000C00000C0000046:200C000010000500000010002005C0000000C0C0C000D080D0100000C000C000D0FFD0102B:200C800000C000D0FFD0201000C0C00000C0C0000000C0000000000000D0FF4000C0C0C0B6:200D0000100005000000001000000000000080401000C000000005000000C0010000C0C0D8:200D8000C010000500000010002005C000C0C0C00000C0000000FFC000000080401000C03A:200E00000000C0CF00000580D000C000D0FF40D030201000C00011FF00C000102105001019:200E8000FF0010000500000000102030000000D08040100000001000FF00C000000010FF60:200F000000C0000080354030201000C000000004000000C0000000C0C000C0C000C0C000B8:200F80000080401000C00000C0CF00000480D000C000D0FFD000C000D0FFD000C000D0FF91:20100000354000C000000004000000C00100C00000C00000C000000080401000C00000C046:20108000CF0000048040100000000000C01000C0C100C000C00000C000000000C0000080DC:201100004000000000000005000000FFC000C0C1C0C000C0101100C000C00000C0000000A9:2011800000C000000080D000C000C0000000C000C0C10000000000D0FFD000C000C000005F:2012000000C000C0C10000000000D0FF354000C000000003000000C000000080401000C036:201280000000C0CF0000038040D0100000FB00FB00C000FF0010FBD0803440D0100000FFB9:2013000000C0C0C0C0C0C000C01000FD00C01000FD00C01000FD0000FF00C01000FD00001A:20138000100200C000FFC0FFC0FFC0FFFFD0804000C0000000030000000002C00000C0006B:20140000FD0080401000C00000C01000FD001002C0CF00000380344000C000000003000017:2014800000C0060000000080401000C00000001000C0CF000003804000C0000000030000D1:2015000080401000C000000003000080402010000003804010000010008040100000008015:20158000401000C0000000030000804020100000100080401000000080401000C0000000D8:2016000002000080D00000D0FFD000C000D0FF4000C00000000200000000FF100000000039:20168000C000C000000080401000C000000000C0CF000002804000C000FFC0C0C000FFC02B:20170000C0C0C000FFC0C0C0C000000000FFC0C01000FF001020FFC0C0C000C000FF80400E:20178000000010FF00C0C000FFC0102000FFC0C0C000FFC0102000FFFF0080400000FFC020:2018000000FFC01000FFC000FFC01000FFC0001020FFC0000080401000C001010280401059:2018800000C0C0100002000000C000C0C0FF0080D000D0FFD000D0FF401000C000000002A7:201900000000000010FF0080401000C0000000020000001000FE1000FFC01000FF0080407A:201980001000C0000000020000001000FE1000FFC01000FE00804000C00000000100000009:201A000000FEC000000080401000C000000010FEC0CF00000180D00000D0FFD00000D0FF1C:201A8000D000D0FF656C726534331D40D0100000FD00C0C000C00010C10000C0C0C0C0004D:201B0000FDC000FFC0C0C00000FD2010000000C000FFC0FFD0804000C1C0000021100130AB:201B80000301C0C0FF8040D0201000C1C0C0C000C00000000300FF001003C0C0C0C0C0C0AC:201C0000C00000FFD08040D0201000C1C0C0C000C00000000300FF00C0100003C0C0C0C0DF:201C80000000FF00D0804000C0000000010000000000C0000000FF0080401000C0000000A5:201D00001000C0CF000001804000FF00001000FF804000FF0003803333003433334000C013:201D8000000000010000000000C000000080401000C00000001000C0CF000001803400039B:201E0000D01000D0FF4000C000000000000000C00000C00000C000FBC0000080401000C088:201E80000000C0CF000000804000C000FC00C0C0C0C01000100010C0FFC01000FBFF34004A:201F0000D000D0FFFF4000C00000000000000000FFC000000080401000C000000010FFC005:201F8000CF00000080D000C000D0FFD01000D0FF34004000000000100000804000C00000E0:20200000000000000000FFC000000080401000C000000010FFC0CF00000080D000C000D0F3:20208000FFD01000D0FF40000002C0C0C0000000C0C0C000C000FF0002C0C0C00000FFC010:20210000C0C000C000FFFF3400384050C04000010010200000001000C00048480001FF8074:202180000000FFC040E0FF47C000FFC000FFFF333340D000FC00FF1000FCD00080405060E0:20220000705000024000800040FF00FF0080333100FF02FFD01000C00010200000D0FFD0AB:202280001000C00010200000D0FFD01000C00010200000D0FFD0100010C010200C000000E4:20230000D0FFD0201000D0FF00FF40000000102000FF0040FF10140000180000E000000056:2023800040C030205030FF00004000100010001040FF00FF400000000000000020505020A0:20240000FF002080300020C0F130308000101080005050802030F23030803030800030301A:202480003030803030208000FF000000FF20003030383020FF008020303020203030802017:2025000000303034303430343020FF2080303020FF8040D000C0C0C0C0C0C010C0C0002031:202580003000D08040D01000C0C0C0C0C0C0C0C00010203000D08040D0201000C0C0C0C0AB:20260000C0C0C0C03010002000D080D000C0C0C0000000C00000C0C0C0C0C000FFD0FFD0DC:2026800000C00000D0FF400000FF00FF80D0100000C0C0D0FF40000010FF8040000010FFA0:202700008040000010FF80D0100000C0C0C000C0C4C0D0FFD0100000C0C0D0FFD01000C068:2027800000100000C010000000D0FFD0100000C000000000C000000000C000FFFFD0FFD0CD:202800001000FFC0000000FFD0FF40D0100000C00000C0000000C00000000010FF0010FF9D:202880000010FFD080D0100000C0C0D0FFD000C0000000D0FFD000C0000000D0FFD000C05C:202900000000D0FFD000C0000000D0FF40D03020100000C0000000FF00FF1000FF0010FF3D:202980000010FF0010FFD080D000C0C0C0C0C000000000D0FFD000C0C0C0C0C000000000DA:202A0000D0FFD01000C000C0C0D0FFD01000C000C0C0D0FF404000008050C00000000000F9:202A80000000C010FF00C0FF0000FF80C010C010C0C000FF3333332A014000102000FE8058:202B00004000102000FE804000102000FE804000102000FE0080C6C040FF06C600C6C0C014:202B8000C0C0C005C0C5C0FF801520C00000200000C0C000C0FFC000C0FFC0FF1540C02065:202C000000003000E00000000020C000003020004000FFC0C0804040C500C00000FFC4C0AD:202C8000FFC0C060C450FF00304400C0FF00800050FF00FFC000000000C0C0FF60C0C0C062:202D0000C0FF00804050C480C00000FFC4C0FFC45030006000600000003000FFFF004410D8:202D800000032F0010001010C050C0005000C0CF6000C0CF500000000000FFC000C0C0C0E4:202E00000000000000FFC000C0C00000FF00FFC000C000C0C000C0FFC0FF80437050C38031:202E80000000FF700000C000FF00830000FFC2C0FF6042C00FC090C00060000000001222EC:202F000010C0100000C0001F00C0C03000FF0000000050C000C0C0C050C0C000FF0000FF25:202F800050C0001020FD00FFC0FF00FFFFFF000000C0C0C050C0C0C000FFC0FF0083478061:2030000040500000C10000C00000FF70000000FEC1C0FFC0C090C16100100000A0C0207080:2030800030C0C040C00030700040FF00000000FF000000C0FF0087FEC000C05000C0C0FE10:2031000000C0C0C00000C0C0FEC0FF0087400100FEC00080101120801020FF803320333303:2031800033331FFF00FF40FFFFC040C040FFC0C0000000FFC0C00000FFC0C0FFFF8033330D:02320000333366:2033F8000000001A001A001A001A0000001D0014001D001D0000001F001F001F0000002065:20347800002000200000001200120000001400120000001C001A0000001D001D0000001E1C:2034F800001D00000001000000010000000500000009000000070000000D0000000F000064:02357800001041:2035800000333B0033550033A30033000033BA0033000000003300003300331A0033200006:20360000332000330000332100332100331200330000330000330000330000330000330005:013680000049:023684001D0027:00000001FF"
#define test_byte_2 ":020000040002F8:200000000000002D9F70009F70009F750000009554FFBD009011005200908152FF9200D025:20008000C152FF1062809052FF2FFF02029F7CA0A09C8C00FF2D8D9D5C00A000508D009DFA:200100009F8C9DA0009DBD2D8D8D9D5C009DA0009DB0009D00BD2D8D9D00BD022D8D8D9DFF:200180005C00A000508D009D9F8C9D9DA0009DBD2D8D8D9D5C009DA0009DB0009D00BD2D39:200200008D9D00BD022DCD8D8D8D9D9C5C009FA0009FA0009D9D009D9D8C009D9D8C00DD9E:200280005C009D9D8C009D9D8C009D9D8C009D9C9D9C00009D9C9D9C008DBD2DCD8D8D9DD1:200300005C00A000508D009D9F8C9DA08C9DA08C809DA08CC04C9D809DDDC0009D9F8C9D99:200380009F8C9D9F8C9D9F8C9D9F8C009D9F8C9D9F8C9D9F8C9D9F8C9D9F8C009D9F8C9D8D:200400009F8C9D9F8C9D9F8C9D9F8C009D9F8C9D9F8C9D9F8C9D9F8C9D9F8C009D9F8C9D0C:200480009F8C9D9F8C9D9F8C9D9F8C009D9F8C9D9F8C9D9F8C9D9F8C9D9F8C009D9C5CFF5D:200500005CFF5CFF5CFF5CFF5CFF009D9FDDA0FF009D9FDDA0FF009D9FDDA0FF009D5CFFF4:200580005CFF5CFF9DBD2D8D8D9D5C009DB0009D00BD4D8D9D9CA0A09D90808D2F4D8D9D31:200600009CA0A09D90808D2F2D8D9D9C9D9C00BD2D8DA0CD9DDC5C009D9C9D9C00CD009DD4:200680009C9D9C00CDDDBD00000231313131310505050505050505050505050505050505D2:20070000050505050505050500002D8D8D9D5C00A000508D009D9F8C9D9DA0FF9DBD2D8D3F:200780008D9D5C009DA0FF9DB0009D00BD2D8D9DFFBD2D8D9DFFBD2D8D9DFFBD2D8D9DFF61:20080000BD022D8D8D9D5C00A000508D009D9F8C9D9D9C809D9D9C809D9D9C809D9D9C803C:200880009D9D9C809D9D9C809D9D9C809D9DDCC09DBD2D8D8D9D5C00A000508D009D9F8CA1:200900009D9DFF9DBD2DCD8D8D009D9DFF009D9D8CFF009D9DFF00DD5CFF5CFFFFBD2D8DF0:200980009D5C00A000508D009D9F8C9DA0FF9DA08CFF9DBD2D8D8D9D5C009DA08CFF9DA076:200A0000FF9DB0009D00BD4D8D8D2F2D4DCD8DDD9D8DFF8DFF8DA0FF8DBD2D4DCD8DDD9D70:200A80008DFF8DFF8DA0FF8DBD2D4DCD8DDD9D8DFF8DFF8DA0FF8DBD2D4DCD8DDD9D8DFF12:200B00008DFFA0CD8DFFDD8DBD0202022D8D9DA0008D9DA000508D009D0000A0BD2D4D8D84:200B80008D9D9C8D009D9D008D9D9D9D0050FF9D9C5C009D9D809D9D008D9DA08C9DA08C6D:200C00009DA000508D00A09DA0009DA08C9D9D809D8C8DBD4D8D8D9D9D90808C8D2F4D8D14:200C80008D9D4C8D2F4D8D8D8D9D9C5C009D9C5C009D9D905C00A000A08D2F2D8D9D8C8D72:200D00009DA000508D009D9D0000A08D9D8DBD2D8D8D9D5C00A000508D009D9F8C9D9D802C:200D80009D9CA000508D00A09DA0009D00A08D9DA08C9DA08C9DFF9D8C9D8DBD2D8D8D9DD4:200E00005C009DB0009D00BD4D8D9D9C8D2F2D4D8D8D8D8D9D9DA0FF8D9D9D9DA0009DA038:200E8000FF8D9DA000508D009D9D9D9D0000A08DBD2D8D8D9D00A09DFF8D9DA08C9D9DFF9F:200F00008D9DA08CBD022D8D8D8D8D9D5C00A000508D009D9F8C9D9D809D9D809D9D809D52:200F80008DBD2D8D8D9D5C009DB0009D00BD4D8D9D9C8D2F4D8D9D9C8D2F4D8D9D9C8D2FB3:20100000022D8D9D5C00A000508D009D9F8C9DA08C9DA08C9DA08C9DBD2D8D8D9D5C009D44:20108000B0009D00BD2D8D8D9D0050009D9D9C9D819D9D909C5C009D9C808C009DA08CBD91:201100002D8D9D005000A0009D0050FF9D9D9C908D9D9D9CA0809D9D909C5C009D9C808CAC:20118000009DA08C9DBD4D8D9D9D9C905C009D9D9C905C00A000A08D2F4D8D9D9D9C905C36:20120000009D9D9C905C00A000A08D2F022D8D9D5C00A000508D009D9F8C9DBD2D8D8D9DD8:201280005C009DB0009D00BD2D4D8D8D8DFF8DFFCDDD5CFF8DA0FF8DBD022D4D8D8D9DFFF2:201300008D9DDCCD9DDCCD009DDD8CFF009DDD8CFF009DDD8CFF009DFF8D9DDD8CFF8D9D4D:201380008D0000DD5CFF5CFF5CFF5CFFFF8DBD2D8D9D5C00A000508D009D009D9F8C9D8C70:20140000FF9DBD2D8D8D9D5C009DA08CFF9DA0009DB0009D00BD022D8D9D5C00A000508D55:20148000009D9F8C9D009DBD2D8D8D9D5C009DA0009DB0009D00BD2D8D9D5C00A0008D9DEC:20150000BD2D8D8D9D5C00A0008D9DBD2D8D8D8D9D00BD2D8D8D9DA000BD2D8D8D9D00BD37:201580002D8D8D9D5C00A0008D9DBD2D8D8D8D9D9D00BD2D8D8D9D00BD2D8D8D9D5C00A038:20160000008D9DBD4D8D9D8D2F4D8D9D8C8D2F2D8D9D5C00A000508D008DFFA09D009D005B:201680009D8C9DA08C9DBD2D8D8D9D5C009D009DB0009D00BD2D8D9D9CFF908D9D9CFF9D96:201700009C809D9CFF9D9C809DA08C009DFF908D9D9DFF9D9DA0FF9D8D9D9D9C5CFFBD2DE3:201780008D9DA0FF8DA08D9DFF9DA08D8CFF9D8C8D9DFF9DA08D8CFFFF9DBD2D8D9DFF9DE2:201800009CFF9DA08CFF9D9CFF9DA08CFF9D9D9CA0FF9DA08CBD2D8D8D9DA08000BD2D8DEF:201880008D9D8D9DA000508D009D9D9C80FF8DBD4D8D8D2F4D8D8D2F2D8D8D9D5C00A000CC:20190000508D009D9DFF9DBD2D8D8D9D5C00A000508D009D8DFFA09DFF9D9D8CFF9DBD2DE9:201980008D8D9D5C00A000508D009D8DFFA09DFF9D9D8CFF9DBD2D8D9D5C00A000508D0003:201A00009DFF9D9F8C9DBD2D8D8D9D5C009DA0FF9DB0009D00BD4D8D8F8D2F4D8D9F8D2F8B:201A80004D8D8D2F725F76000202022D4D8D8D9DFF8DA08D009D9D9DD09D40C19D8C8D9DE1:201B0000FF9D50FF9DDCCD009DFF9D409D0000DD5CFF5CFF8DBD2D8D9F9C5C009FA09FA0D2:201B8000009FA080FFBD2D4D8D8D8D9F8DA08D9D9D5C009D0050FF9D9D009D8C8D9D8C8D28:201C00009D9D5CFF8DBD2D4D8D8D8D9F8DA08D9D9D5C009D0050FF9D9D809D009D8C8D9D3F:201C80009D5CFF9D8DBD2D8D9D5C00A000508D009D009D9F8C9DFF9DBD2D8D8D9D5C009DFD:201D0000A0009DB0009D00BD2DA0FFA000A0A0FFBD2D9FFF9F00BD0202020202022D8D9D8A:201D80005C00A000508D009D009D9F8C9DBD2D8D8D9D5C009DA0009DB0009D00BD02A000E5:201E00004D8D8D8D2F2D8D9D5C00A000508D009D9F8C9D9F8C9D9CFF9D8C9DBD2D8D8D9D40:201E80005C009DB0009D00BD2D8D9D9CFF8D9D9C8C8D9D9DD1819D9C2F9D9D9CFFFF0200A4:201F00004D8D8D2F2F2D8D9D5C00A000508D009DFF9D9F8C9DBD2D8D8D9D5C009DA0FF9DF5:201F8000B0009D00BD4D8D9F9C8D2F4D8D8D8D2F020F2DA000A000A0A000BD2D8D9D5C0015:20200000A000508D009DFF9D9F8C9DBD2D8D8D9D5C009DA0FF9DB0009D00BD4D8D9F9C8DC0:202080002F4D8D8D8D2F2D8DA000A08D9D9F50009D8C8D9F9D50FFA000A08D9D9F50FF9DA5:202100008C8D9F9D50FFFF0210012DA0D5A000808580915200919100D584A0A05CA0FFBDEC:2021800014002FA0A08F2FC09F8C2F9F8C2F2F02022D4DA0FFA0FFA0A0FF8DA0BD2DB09FFA:202200009FA0A0009750BD54A02F56FFA0BD0202502F002F4D8D8D9D9D9CA0818C8D2F4DC1:202280008D8D9D9D9CA0C18C8D2F4D8D8D9D9D9CA0218C8D2F4D8D8D9D9D91A011A000A03C:202300008D2F4D8D8D8D8D2FA02F2D100052C05210FF52BD2F01815200815200A052002DCE:20238000A0A04202A053FFBD12A0128012C012C0BD2F522F2D1100100052002D42B1A05203:20240000FFBD92BD1200D24F8C9180BD00B1A0BD00B1A0BD524F83D1C0BDD1C0BDA0D1C017:20248000D1C0BDD1C052BD11FF100010FF520091C0A04052FF72BD92D1C04292D1C0BD5285:202500000091C0A040A040A04052FF92BDD1C052FFBD2D4D8DA08DA08DA08DA0A08D9DA0F3:20258000A0008DBD2D4D8D8DA08DA08DA08DA08D9D9DA0A0008DBD2D4D8D8D8D9D8DA08DCD:20260000A08DA08D9D9DA0A0008DBD4D8DA08D9D9C808C9D5C009D9C0C8D9D5CFF8D2F4D84:202680008D9DA08C8D2F2D8D9DFF9DFFBD4D8D8D9D9D808D2F2D8D9DA0FFBD2D8D9DA0FFF3:20270000BD2D8D9DA0FFBD4D8D8D9D9D0C809D9DA0808D2F4D8D8D9D9D808D2F4DCD8D9DE5:20278000DD9CC18C9DDD9C818C8D2F4DCD8D009D9CC08C009D9C808C00DD5CFFFF8D2F4DE3:202800008D8DFF9D9CC08CFF8D2F2D4D8D8D9D8D908C9D9CC08C9D9CC08C9DDDFF9DDDFF89:202880009D9DFF8DBD4DCD8D9DDD808D2F4D8D9D9C808C8D2F4D8D9D9C808C8D2F4D8D9D2B:20290000A08C8D2F4D8D9D9C808C8D2F2D4DCD8D8D8D9D8D908C9DFF9DFF9D9DFF9DDDFFD6:202980009D8DFF9D9DFF8DBD4D8D9D9C0C8D9D5CA000A08D2F4D8D9D9C0C8D9D5CA000A005:202A00008D2F4D8D8D9D9DDC808D2F4D8D8D9D9D9CC08D2F2D9F9450BD9FA09C849C5000D0:202A800055009CA02F009C2F9450FFBD9F9F819F9180812F02020202002DCDDDA0A0FFBD11:202B00002DCDDDA0A0FFBD2DCDDDA0A0FFBD2DCDDDA0A0FFA0BD9F9C2D2F9F9F8C9F9C4CB4:202B800080A0809F809F9C2FBD9FA0910050A00052909000822F925CA0FF812F9F2D91B022:202C00008100A000905E00538180A0A000A093529283FFA080BD2DB09F009C5C00FF9F9CED:202C80002F84CC4C9F9CFF55959F00942FA0BD5695FFA0FF435C0085804C80FF85958C8563:202D0000942F85BD2DB09FBD9C5C00FF9F9C2F9F45A055A000A096C0838055FFFF559F93C8:202D8000009FB090C10083838C814C5CA05696B0A05595B0A056005500A0FF9395808C83C1:202E0000A0005500A0FF9693808C00A0FFA0FF96938095808CA086FF942FBD2DB0479FA059:202E800000A0FFA000589C00FFA0BD5C00FF9F9C2F959F88B0CC4C940046560056009F9F96:202F00009185828C519C00B000864C9C00FF53898085A094008985898C4385A0FF00A0FF45:202F8000B09400A0A0FFA0FF942FA0FF2FFF4650008985898C408C8585FF942FA0BD2DA004:20300000B04800589F00189C00A0FFA0005C00FF9F9C2F84CC4C9F9F9CE0500080859001CD:20308000474A824C800088885344FF54900050FF005000962FA0BDFF895A8347004580FF96:203100005495848500874480FF962FA0BD2D04A0FFB0A0BD84B0A0BD518CFFBD0200020244:203180000202002FA02F2DFFFF9F2D9CA02F9F9C5C00A02F9F9C5C002F9F9C2FFFBD020275:023200000202C8:2033F80000000002000200020002000000020002000200020000000200020002000000029D:2034780000020002000000020002000000020002000000020002000000020002000000021E:2034F8000002000000020000000200000002000000020000000200000002000000020000A4:0235780000024F:2035800000021200029A0002F600020000026C000200000000020000020002020002000007:20360000020000020000020200020200020000020000020000020000020000020000020090:013680000049:02368400020042:00000001FF"
#define test_byte_3 ":020000040002F8:2000000010EBEBE9E5E31BE5E31BE5E30AEAEBE4E31AE8EAE4E31AE24AE4E4E25AE20AE410:20008000E4E21AE21210E4E31AE1FF0000E5E303011512EAFFE9E5E5E31AE3EBE3E50AE5AA:20010000E5E5E5E3EBE5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE8E9E5E5EBE800E9E5E5E5B7:20018000E31AE3EBE3E50AE5E5E5E5E5E3EBE5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE8E905:20020000E5E5EBE800E9E5E5E5E5E5E5E31AE5E3EBE5E3EBE5E5EBE5E5E2EBE5E5E2EBE5CF:20028000E30AE5E5E2EBE5E5E2EBE5E5E2EBE5E5E5E5EBEAE5E5E5E5EBE5E8E9E5E5E5E57A:20030000E31AE3EBE3E50AE5E5E5E5E1E0E5E1E2E5E5E1E0E3E0E5E5E5E5E5EAE5E5E5E5FE:20038000E5E5E5E5E5E5E5E5E5E5E5EAE5E5E5E5E5E5E5E5E5E5E5E5E5E5E5EAE5E5E5E5B3:20040000E5E5E5E5E5E5E5E5E5E5E5EAE5E5E5E5E5E5E5E5E5E5E5E5E5E5E5EAE5E5E5E532:20048000E5E5E5E5E5E5E5E5E5E5E5EAE5E5E5E5E5E5E5E5E5E5E5E5E5E5E5EAE5E5E20A90:20050000E20AE20AE20AE20AE20AEAE5E5E5E3EBEAE5E5E5E3EBEAE5E5E5E3EBEAE5E20A4F:20058000E20AE20AE5E8E9E5E5E5E30AE5E10AE5EBE8E2E5E5E5E3E1E5E5E5E2E1E2E5E536:20060000E5E3E1E5E5E5E2E1E9E5E5E5E5E5EBE8E9E5E3E5E5E5E30AE5E5E5E5EBE5EAE50A:20068000E5E5E5EBE5E5E8484800484848484849494949494949494949494949494949493D:2007000049494949494949494848E9E5E5E5E31AE3EBE3E50AE5E5E5E5E5E3EBE5E8E9E5EA:20078000E5E5E30AE5E3EBE5E10AE5EBE8E9E5E5EBE8E9E5E5EBE8E9E5E5EBE8E9E5E5EB37:20080000E800E9E5E5E5E31AE3EBE3E50AE5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5BC:20088000E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E5E8E9E5E5E5E31AE3EBE3E50AE5E5E557:20090000E5E5EBE5E8E9E5E5E5EAE5E5EBEAE5E5E2EBEAE5E5EBEAE5E30AE20AEAE8E9E5B6:20098000E5E31AE3EBE3E50AE5E5E5E5E3EBE5E3E2EBE5E8E9E5E5E5E30AE5E3E2EBE5E32F:200A0000EBE5E10AE5EBE8E2E5E2E1E9E2E5E5E5E5E2EBE2EBE2E3EBE2E8E9E2E5E5E5E507:200A8000E2EBE2EBE2E3EBE2E8E9E2E5E5E5E5E2EBE2EBE2E3EBE2E8E9E2E5E5E5E5E2EBA3:200B0000E2EBE3E5E2EBE5E2E8000000E9E5E5E3EBE5E5E3EBE3E50AE5EBEAE3E8E9E2E5A4:200B8000E5E5E5E5EAE5E5EBE5E5E5E5EBE30AE5E5E31AE5E5E5E5E5EBE5E5E3E5E5E3E54C:200C0000E5E3EBE3E50AE3E5E3EBE5E3E5E5E5E5E5E2E2E8E2E5E5E5E5E5E0E2E2E1E2E525:200C8000E5E5E2E2E1E2E5E5E5E5E5E31AE5E5E30AE5E5E5E1CAE3EAE3E2E1E9E5E5E2E58F:200D0000E5E3EBE3E50AE5E5EBEAE3E5E5E5E8E9E5E5E5E31AE3EBE3E50AE5E5E5E5E5E5A2:200D8000E5E5E3EBE3E50AE3E5E3EBE5EAE3E5E5E3E5E5E3E5E5EBE5E5E5E5E8E9E5E5E57E:200E0000E30AE5E10AE5EBE8E2E5E5E5E2E1E9E2E5E5E5E5E5E5E1EBE5E5E5E5E1EBE5E3EC:200E8000EBE5E5E3EBE3E50AE5E5E5E5EBEAE3E2E8E9E5E5E5EBE1E5EBE5E5E3E5E5E5EB6C:200F0000E5E5E3E5E800E9E5E5E5E5E5E31AE3EBE3E50AE5E5E5E5E5E5E5E5E5E5E5E5E5B7:200F8000E5E8E9E5E5E5E30AE5E10AE5EBE8E2E5E5E5E2E1E2E5E5E5E2E1E2E5E5E5E2E17B:2010000000E9E5E5E31AE3EBE3E50AE5E5E5E5E3E5E5E3E5E5E3E5E5E8E9E5E5E5E30AE593:20108000E10AE5EBE8E9E5E5E5EBE31AE5E5E5E5E7E5E5E5E5E1DAE5E5E2E5EAE5E3E5E853:20110000E9E5E5EBE30AE3EBE5EBE31AE5E5E5E7E5E5E5E5E3E7E5E5E5E5E1DAE5E5E2E5D5:20118000EAE5E3E5E5E8E2E5E5E5E5E5E11AE5E5E5E7E31AE3EAE3E2E1E2E5E5E5E5E5E153:201200001AE5E5E5E7E30AE3EAE3E2E100E9E5E5E31AE3EBE3E50AE5E5E5E5E8E9E5E5E55A:20128000E30AE5E10AE5EBE8E9E2E5E5E2EBE2EBE5E5E30AE2E3EBE2E800E9E2E5E5E5EB14:20130000E5E5E5E5E5E5E5EAE5E5E2EBEAE5E5E2EBEAE5E5E2EBEAE5EBE5E5E5E2EBE5E507:20138000E2EBEAE5E30AE20AE20AE20AEAE2E8E9E5E5E31AE3EBE3E50AE5EBE5E5E5E5E2B6:20140000EBE5E8E9E5E5E5E30AE5E3E2EBE5E3EBE5E10AE5EBE800E9E5E5E31AE3EBE3E579:201480000AE5E5E5E5EBE5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE8E9E5E5E31AE3EBE5E5EE:20150000E8E9E5E5E5E31AE3EBE5E5E8E9E5E5E5E5EBE8E9E5E5E5E3EBE8E9E5E5E5EBE8C5:20158000E9E5E5E5E31AE3EBE5E5E8E9E5E5E5E5E5EBE8E9E5E5E5EBE8E9E5E5E5E31AE31E:20160000EBE5E5E8E2E5E5E2E1E2E5E5E2E2E1E9E5E5E31AE3EBE3E50AE2EBE1E5EBE5EBCF:20168000E5E5E5E3E5E5E8E9E5E5E5E30AE5EBE5E10AE5EBE8E9E5E5E5EBE5E5E5E5EBE542:20170000E5E5E5E5EBE5E5E5E5E3E5EAE5EBE5E5E5E5EBE5E5E3EBE5E5E5E5E5E11AE8E9D8:20178000E5E5E3EBE5E3E5E5EBE5E1E2E2EBE5E2E5E5EBE5E1E2E2EBEAE5E8E9E5E5EBE594:20180000E5EBE5E1E2EBE5E5EBE5E1E2EBE5E5E5E3EBE5E3E5E8E9E5E5E5E1E0EBE8E9E511:20188000E5E5E5E5E3EBE3E50AE5E5E5E5EAE5E8E2E5E2E1E2E5E2E1E9E5E5E5E31AE3EB52:20190000E3E50AE5E5EBE5E8E9E5E5E5E31AE3EBE3E50AE5E2EBE1E5EBE5E5E2EBE5E8E98E:20198000E5E5E5E31AE3EBE3E50AE5E2EBE1E5EBE5E5E2EBE5E8E9E5E5E31AE3EBE3E50AE4:201A0000E5EBE5E5E5E5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE8E2E5E2E2E1E2E5E5E2E1DF:201A8000E2E5E2E169536900000000E9E2E5E5E5EBE5E3E5EAE5E5E5E7E5E2E7E5E2E5E5C6:201B0000EBE5E1CAE5E5E5EAE5EBE5E2E5EBEAE5E30AE20AE2E8E9E5E5E5E31AE5E3E5E3B3:201B8000EBE5E3E5EAE8E9E2E5E5E5E5E5E3E5E5E5E1DAE5EBE30AE5E5EBE5E2E5E5E2E580:201C0000E5E5E1CAE2E8E9E2E5E5E5E5E5E3E5E5E5E1DAE5EBE31AE5E5E0E5EBE5E2E5E51C:201C8000E5E1CAE5E2E8E9E5E5E31AE3EBE3E50AE5EBE5E5E5E5EBE5E8E9E5E5E5E30AE52F:201D0000E3EBE5E10AE5EBE8E9E1EBE1EBE3E1EBE8E9E5EBE5EBE8000049000000E9E5E5E8:201D8000E31AE3EBE3E50AE5EBE5E5E5E5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE800E3EACD:201E0000E2E5E5E2E1E9E5E5E31AE3EBE3E50AE5E5E5E5E5E5E5E5EBE5E5E5E8E9E5E5E5C1:201E8000E30AE5E10AE5EBE8E9E5E5E5EBE5E5E5E2E5E5E5E1E0E5E5E1E5E5E5EBEA0020FA:201F0000E2E5E2E1E1E9E5E5E31AE3EBE3E50AE5EBE5E5E5E5E8E9E5E5E5E30AE5E3EBE59D:201F8000E10AE5EBE8E2E5E5E5E2E1E2E5E5E2E10082E9E1EBE1EBE3E1EBE8E9E5E5E31A91:20200000E3EBE3E50AE5EBE5E5E5E5E8E9E5E5E5E30AE5E3EBE5E10AE5EBE8E2E5E5E5E2A1:20208000E1E2E5E5E2E1E9E5E3EBE3E5E5E5E1DAE5E2E5E5E5E1CAE3EBE3E5E5E5E1DAE5E6:20210000E2E5E5E5E1CAEA008200E9E1E1E3EAE0E0E2E5E30AE5E5EBE1E2E1E1E1E1CAE87D:20218000E31AE1E1E1E2E146E5E5E1E5E5E1E10000E9E2E1EBE1EBE3E1EBE2E3E8E9E1E5F1:20220000E503E1EBE5E318E301E1E11AE3E80000E301EAE1E2E5E5E5E5E5E3E1E5E2E1E247:20228000E5E5E5E5E5E3E1E5E2E1E2E5E5E5E5E5E3E0E5E2E1E2E5E5E5E5E5E3E1E30AE3A4:20230000E2E1E2E5E5E5E2E1E1E1E9E30AE38482831AE30801E2E1E33AE1E33AE1E33AE9D7:20238000E1E1E2E2E8E28AE8E318E314E310E315E8E1E301E9E31AE31AE33AE9E2E8E8E274:202400002AE8E208E20AE3E2E0E4E408EAE8E808EAE8E808E21210E4E4E8E0E0E8E1E0E0DE:20248000E4E4E8E4E4E208E31AE31AE30AE23AE4E0E1E1E22AE308E2202022E22424E8E222:202500003AE4E4E1E5E1E5E1E5E22AE208E4E4E21AE8E9E2E5E3E5E3E5E3E5E3E3E5E5E34A:20258000E3EFE2E8E9E2E5E5E3E5E3E5E3E5E3E5E5E5E3E3EFE2E8E9E2E5E5E5E5E5E3E595:20260000E3E5E3E5E5E5E3E3EFE2E8E2E5E3E5E5E5E3E5E5E30AE5E5E2E5E5E31AE2E1E2D6:20268000E5E5E3E5E2E1E9E5E5EBE5EBE8E2E5E5E5E5E5E2E1E9E5E5E3EBE8E9E5E5E3EB87:20270000E8E9E5E5E3EBE8E2E5E5E5E5E2E5E5E5E1E5E2E1E2E5E5E5E5E5E2E1E2E1E5E52D:20278000E1E5E1E5E5E1E5E1E5E2E1E2E1E5EAE5E5E3E5EAE5E5E3E5EAE1E30AEAE2E1E292:20280000E5E5EAE5E5E3E5EAE2E1E9E2E5E5E5E2E8E8E5E5E3E5E5E5E3E5E5E1EBE5E1EB13:20288000E5E5EBE2E8E2E5E5E5E5E5E2E1E2E5E5E5E3E5E2E1E2E5E5E5E3E5E2E1E2E5E5B7:20290000E3E5E2E1E2E5E5E5E3E5E2E1E9E2E5E5E5E5E5E2E8E8E5EBE5EBE5E5EBE5E5EB10:20298000E5E2EBE5E5EBE2E8E2E5E5E5E2E5E5E3E31AE3E2E1E2E5E5E5E2E5E5E3E3DAE383:202A0000E2E1E2E5E5E5E5E5E5E2E1E2E5E5E5E5E5E5E2E1E9E5E5E308E5E1E5E5E5E30AED:202A8000E10AE5E3E1EAE5E1E5E31AE8E5E5E5E5E5E5E5E100000000EAE9E5E5E3E3EBE8CE:202B0000E9E5E5E3E3EBE8E9E5E5E3E3EBE8E9E5E5E3E3EBE3E8E5E5E9E1E5E5E5E5E5E2FF:202B8000E5E3E5E5E5E5E5E1E8E5E3E5EAE1111AE305150AE5E1E5E3031AE5E1E5E9E5E17C:202C0000050AE3EAE5E18AE305151111EAE1E5E315051AE3E5E8E9E1150AE5E30AEBE5E582:202C8000E1E2E3E2E5E5EAE315E51AE5E1E3E8E1858AE1EBE0E33AE0E2E2E5EBE5E5E3E5B1:202D0000E5E1E2E8E9E11508E5E30AEBE5E5E1E5E2E1E1939AE1E5E3E0E2E18AEAE1E50593:202D80001AE5E1E5130AE5E0E0E2E2E133E3151113E3151113E31AE30AE1EBE5E5E0E2E575:202E0000E1EAE31AE1EBE5E5E0E2EAE1EBE1EBE5E5E0E5E0E2E1E5EBE5E1E8E9E1E215E1BE:202E80001AE1EBE1EAE3E51AEBE3E8E30AEBE5E5E1E5E5E2E1E3E2E50AE2E10AE18AE5E523:202F0000E5E0E0E2E1859AE11AE0E0E24AEBE330333531E53AE3E5E0E2E2E5E1EBEAE1EBBA:202F8000E1E50AE1E1EBE1EBE5E1E1EAE1EAE0E33AE3E5E0E2E2E3E5E2EBE5E1E1E8E9E135:20300000E1E20AE3859AE1E50AE1EBE1EAE30AEBE5E5E1E2E3E2E5E5E5E1E30AE2E0E5E04C:20308000E2E0E0E0E2EAE0E0E1303AE3455AE31AEAE31AE5E1E3E8EBE3E1E5E20AE0E5EBB0:20310000E33530353AE0E2E5EBE5E1E1E8E9E0E1EBE10308E2E1E308E2E41AE800100000D0:20318000000010E1E1E1E9EBEAE5E9E5E1E1E5E5E30AE1E1E5E5E30AE1E5E5E1EBE80000BA:023200000000CC:2033F8000000000000000000000000000000000000000000000000000000000000000000B5:20347800000000000000000000000000000000000000000000000000000000000000000034:2034F8000000000000000000000000000000000000000000000000000000000000000000B4:02357800000051:2035800000001F0000150000000000000000430000000000000000000000000000000000B4:2036000000100000000000000000000000000000000000000000000000000000000000009A:013680000049:02368400000044:00000001FF"


int main(int argc, char **argv) {

	code_t* code_begin;
	code_t* current;

	code_bytes_t code_bytes;
	code_bytes.byte_0 = test_byte_0;
	code_bytes.byte_1 = test_byte_1;
	code_bytes.byte_2 = test_byte_2;
	code_bytes.byte_3 = test_byte_3;

	code_begin = parser_parse(&code_bytes);
	current = code_begin;
	while(current != NULL) {
		int i = 0;
		printf("> byte_count: %x, addr: %x\r\n\t", current->byte_count, current->address);

		for(i = 0; i < current->byte_count; i++) {
			if(i % 4 == 0) {
				printf(" ");
			}
			printf("%x%x", current->bytes[i] >> 4, current->bytes[i] % 16);
		}
		printf("\r\n");

		current = current->next;
	}

	printf("deleting...\r\n");
	parser_free_parsed_code(code_begin);

	return 0;
}
